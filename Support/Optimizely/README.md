# Tealium Optimizely Tracker (iOS)


## Purpose

This module listens for events triggered by the "Optimizely X" iOS library, and passes the event data to Tealium. Specifically, it listens for:

* Experiment activation
* Event tracking calls

You can find more information on the Optimizely X library here: 
[https://developers.optimizely.com/x/solutions/sdks/introduction/index.html?language=android&platform=mobile](https://developers.optimizely.com/x/solutions/sdks/introduction/index.html?language=objectivec&platform=mobile)

## Implementation Instructions

Initialize your Tealium SDK instance and then initialize the TealiumOptimizelyTracker instance as follows:

```objective-c
		    TEALConfiguration * tealConfig = [TEALConfiguration configurationWithAccount:@"myaccount" profile:@"myprofile" environment:@"dev"];
		    
		    instance = [Tealium newInstanceForKey:@"myinstancename" configuration:tealConfig];
		    
		    TealiumOptimizelyTracker * tealOpt = [TealiumOptimizelyTracker sharedInstance];
		    
		    [tealOpt addInstanceWithName:@"myinstancename"];
```

Once you have initialized the module, no additional config is required. The module will now listen for notifications from the Optimizely SDK and pass the data to the Tealium SDK as required.

## Tracked Events
* When the Optimizely SDK starts/activates an experiment, a Tealium ```trackEvent``` call will be generated, with an event name of "Optimizely Experiment Started"

* Whenever the Optimizely SDK receives a custom event (generated by manually calling the Optimizely SDK's ```track``` method), a Tealium ```trackEvent``` call will be generated, with an event name of "Optimizely Event Tracked"

## Variables Passed To Tealium
(Please note: "Variables" were formerly called "Data Sources")

The following variables are collected by default:

| Variable                    | Scope              | Experiment Activation | Event Tracking | Description                                                                                                               |
|-----------------------------|--------------------|-----------------------|----------------|---------------------------------------------------------------------------------------------------------------------------|
| optimizely\_experiment\_key | Volatile (session) |           X           |        X       | Optimizely experiment name (e.g. "Homescreen MVT")                                                                        |
| optimizely\_variation\_key  | Volatile (session) |           X           |        X       | Optimizely variation name (e.g. "Variation A")                                                                            |
| optimizely\_user\_id        | Volatile (session) |           X           |        X       | Optimizely user ID (e.g. "alice@tealium.com")                                                                             |
| optimizely\_event\_key      | Hit (single event) |           X           |        X       | Optimizely  event name (e.g. "purchase")                                                                                  |
| optimizely\_event\_value    | Hit (single event) |           X           |        X       | Optimizely event value (e.g. "123" - integer values only)                                                                 |
| optimizely\_XXX             | Hit (single event) |           X           |        X       | Optimizely custom attribute prefix. All custom attributes are prefixed with "optimizely\_" and passed directly to Tealium |


### Overriding default variable names (optional)
The default variable names can be overridden easily if you prefer a different naming convention. Overriding variable names can be done by changing a set of public properties on the TealiumOptimizelyTracker class.
 
```objective-c
...
TealiumOptimizelyTracker * tealOpt = [TealiumOptimizelyTracker sharedInstance];
		    
[tealOpt addInstanceWithName:@"myinstancename"];
tealOpt.TEOptimizelyUserIdKeyName = @"my_user_id_key";
tealOpt.TEOptimizelyExperimentKeyName = @"my_experiment_name_key";
tealOpt.TEOptimizelyVariationKeyName = @"my_variation_name_key";
tealOpt.TEOptimizelyEventKeyKeyName = @"my_event_name_key";
tealOpt.TEOptimizelyEventValueKeyName = @"my_event_value_key";

```